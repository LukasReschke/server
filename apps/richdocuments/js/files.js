!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/",n(n.s=625)}([function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},,,,,function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(9))},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(9))},,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.values={},this.loadFromGlobal("userId"),this.loadFromGlobal("urlsrc"),this.loadFromGlobal("directEdit"),this.loadFromGlobal("permissions"),this.loadFromGlobal("instanceId")}var t,n,i;return t=e,(n=[{key:"loadFromGlobal",value:function(e){this.values[e]=window["richdocuments_"+e]}},{key:"update",value:function(e,t){this.values[e]=t}},{key:"get",value:function(e){return void 0===this.values[e]&&this.loadFromGlobal(e),this.values[e]}}])&&r(t.prototype,n),i&&r(t,i),e}());t.a=i},,,function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(9))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCapabilities=function(){try{return(0,r.loadState)("core","capabilities")}catch(e){return console.debug("Could not find capabilities initial state fall back to _oc_capabilities"),"_oc_capabilities"in window?window._oc_capabilities:{}}};var r=n(461)},,,function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},,,,function(e,n,r){"use strict";var i=r(48),o=r(81),a=r(83),s=r(11),c=r(324);function l(e,t){return function(e){if(Array.isArray(e))return e}
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value;n.a={fileModel:null,fileList:void 0,views:{},followingEditor:!1,following:null,handlers:{},startLoading:function(){this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!0),this.getFileList().showMask&&this.getFileList().showMask())},init:function(e){var t=this,n=e.fileName,r=e.fileId,i=e.sendPostMessage,o=e.fileList,a=e.fileModel;this.fileName=n,this.fileId=r,this.fileList=o,this.fileModel=a,this.sendPostMessage=i,this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){t._addHeaderFileActions()}))},registerHandler:function(e,t){this.handlers[e]=t},initAfterReady:function(){if(!this.handlers.initAfterReady||!this.handlers.initAfterReady(this)){this.getFileList()&&(this.getFileModel(),this.getFileList().hideMask&&this.getFileList().hideMask(),this.getFileList().setPageTitle&&this.getFileList().setPageTitle(this.fileName));var e=document.querySelector("#header .header-right");if(!document.getElementById("richdocuments-header")){var t=document.createElement("div");t.id="richdocuments-header",e.insertBefore(t,e.firstChild),this._addAvatarList(),d||(this._addHeaderShareButton(),this._addHeaderFileActions(),this.addVersionSidebarEvents())}}},close:function(){this.handlers.close&&this.handlers.close(this)||(this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!1),this.getFileList().reload&&this.getFileList().reload()),this.fileModel=null,d||this.removeVersionSidebarEvents(),$("#richdocuments-header").remove())},saveAs:function(){this.handlers.saveAs&&this.handlers.saveAs(this)||this.getFileList()&&this.getFileList().reload()},share:function(){this.handlers.share&&this.handlers.share(this)||(!d&&this.getFileList()?(this.getFileList().showDetailsView&&this.getFileList().showDetailsView(this.fileName,"shareTabView"),OC.Apps.showAppSidebar()):console.error("[FilesAppIntegration] Sharing is not supported"))},rename:function(e){this.fileName=e,this.handlers.rename&&this.handlers.rename(this)||this.getFileList()&&(this.getFileList().reload&&this.getFileList().reload(),OC.Apps.hideAppSidebar())},insertGraphic:function(e){d&&console.error("[FilesAppIntegration] insertGraphic is not supported");var n=function(t){var n=t.substring(t.lastIndexOf("/")+1);$.ajax({type:"POST",url:OC.generateUrl("apps/richdocuments/assets"),data:{path:t}}).done((function(t){e(n,t.url)}))};this.handlers.insertGraphic&&this.handlers.insertGraphic(this,{insertFileFromPath:n})||OC.dialogs.filepicker(t("richdocuments","Insert from {name}",{name:OC.theme.name}),(function(e,t){t===OC.dialogs.FILEPICKER_TYPE_CHOOSE&&n(e)}),!1,["image/png","image/gif","image/jpeg","image/svg"],!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE)},getFileList:function(){return this.fileList?this.fileList:OCA.Files&&OCA.Files.App?OCA.Files.App.fileList:OCA.Sharing&&OCA.Sharing.PublicApp?OCA.Sharing.PublicApp.fileList:null},getFileModel:function(){var e=this;return this.fileModel?this.fileModel:this.getFileList()?(this.getFileList()._updateDetailsView&&this.getFileList()._updateDetailsView(this.fileName,!1),this.fileModel=this.getFileList().getModelForFile(this.fileName),this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){e._addHeaderFileActions()})),this.fileModel):null},setViews:function(e){var t=this;this.views={},e.forEach((function(e){t.views[e.ViewId]=e})),this.renderAvatars()},followReset:function(e){this.sendPostMessage("Action_FollowUser",{Follow:!1}),this.following=null,this.followingEditor=!1,this.renderAvatars()},followCurrentEditor:function(e){this.sendPostMessage("Action_FollowUser",{Follow:!0}),this.following=null,this.followingEditor=!0,this.renderAvatars()},followView:function(e){this.sendPostMessage("Action_FollowUser",{ViewId:e.ViewId,Follow:!0}),this.following=e.ViewId,this.followingEditor=!1,this.renderAvatars()},_addAvatarList:function(){var e=$('<div id="richdocuments-avatars">');e.on("click",(function(e){e.stopPropagation(),$("#editors-menu").toggle()})),$("#richdocuments-header").append(e)},_addHeaderShareButton:function(){var e=this;if($("header").length){var t=$('<div id="richdocuments-sharing"><a class="icon-shared icon-white"></a></div>');$("#richdocuments-header").append(t),t.on("click",(function(){if(!$("#app-sidebar").is(":visible"))return e.share();OC.Apps.hideAppSidebar()})),$(".searchbox").hide()}},_addHeaderFileActions:function(){var e=this;console.debug("[FilesAppIntegration] Adding header file actions"),OC.unregisterMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu")),$("#richdocuments-actions").remove();var n,r=$('<div id="richdocuments-actions"><div class="icon-more icon-white"></div><ul id="richdocuments-actions-menu" class="popovermenu"></ul></div>'),i=r.find("#richdocuments-actions-menu").empty(),o=function(){return{$file:e.getFileList().$el?e.getFileList().$el.find("[data-id="+e.fileId+"]").first():null,fileActions:e.getFileList().fileActions,fileList:e.getFileList(),fileInfoModel:e.getFileModel()}},a=$("<li><a></a></li>").click((function(t){a.find("a").removeClass("icon-starred").removeClass("icon-star-dark").addClass("icon-loading-small"),e.handlers.actionFavorite&&e.handlers.actionFavorite(e)||(e.getFileList().fileActions.triggerAction("Favorite",e.getFileModel(),e.getFileList()),e.getFileModel().trigger("change",e.getFileModel()))}));(n=this.getFileModel()).get("tags")&&n.get("tags").indexOf(OC.TAG_FAVORITE)>=0?(a.find("a").text(t("files","Remove from favorites")),a.find("a").addClass("icon-starred")):(a.find("a").text(t("files","Add to favorites")),a.find("a").addClass("icon-star-dark"));var s=$('<li><a class="icon-info"></a></li>').click((function(){e.handlers.actionDetails&&e.handlers.actionDetails(e)||(e.getFileList().fileActions.actions.all.Details.action(e.fileName,o()),OC.hideMenus())}));s.find("a").text(t("files","Details"));var c=$('<li><a class="icon-download">Download</a></li>').click((function(){e.handlers.actionDownload&&e.handlers.actionDownload(e)||(e.getFileList().fileActions.actions.all.Download.action(e.fileName,o()),OC.hideMenus())}));c.find("a").text(t("files","Download")),i.append(a).append(s).append(c),$("#richdocuments-header").append(r),OC.registerMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu"),!1,!0)},_userEntry:function(e){var n=this,r=$("<li></li>");r.append(this._avatarForView(e));var i=$('<div class="label"></div>');i.text(e.UserName),"1"===e.ReadOnly&&i.text(e.UserName+" "+t("richdocuments","(read only)")),i.click((function(t){t.stopPropagation(),n.followView(e)})),this.following===e.ViewId&&($("#editors-menu").find("li").removeClass("active"),r.addClass("active")),r.append(i);var o=!d&&this.getFileModel()&&void 0===this.getFileModel().get("shareOwner"),a=this.getFileModel()&&!!(this.getFileModel().get("permissions")&OC.PERMISSION_UPDATE);if(o&&a&&!e.IsCurrentView){var s=$('<div class="icon-close" title="'+t("richdocuments","Remove user")+'"/>');s.click((function(){n.sendPostMessage("Action_RemoveView",{ViewId:e.ViewId})})),r.append(s)}return r},_avatarForView:function(e){var n=""===e.UserId?e.UserName:e.UserId,r=$('<div class="richdocuments-avatar"><div class="avatar" title="'+e.UserName+'" data-user="'+n+'"></div></div>'),i=r.find(".avatar");return i.css({"border-color":"#"+("000000"+Number(e.Color).toString(16)).substr(-6),"border-width":"2px","border-style":"solid"}),"1"===e.ReadOnly?(r.addClass("read-only"),$(i).attr("title",e.UserName+" "+t("richdocuments","(read only)"))):$(i).attr("title",e.UserName),$(i).avatar(n,32,void 0,!0,void 0,e.UserName),r},renderAvatars:function(){var e=this,n=$("#header .header-right #richdocuments-avatars");n.empty();var r=$('<div id="editors-menu" class="popovermenu menu-center"><ul></ul></div>'),i=[],o=0;for(var a in this.views){var s=this.views[a];s.UserName=""!==s.UserName?s.UserName:t("richdocuments","Guest"),r.find("ul").append(this._userEntry(s)),s.UserId!==OC.currentUser&&(""!==s.UserId&&i.indexOf(s.UserId)>-1||(i.push(s.UserId),o++<4&&n.append(this._avatarForView(s))))}var c=$('<li><input type="checkbox" class="checkbox" /><label class="label">'+t("richdocuments","Follow current editor")+"</label></li>");c.find("label").click((function(t){t.stopPropagation(),e.followingEditor?e.followReset():e.followCurrentEditor()})),c.find(".checkbox").prop("checked",this.followingEditor),r.find("ul").append(c),n.append(r)},addVersionSidebarEvents:function(){$(document.querySelector("#content")).on("click.revisions","#app-sidebar .preview-container",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .downloadVersion",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("mousedown.revisions","#app-sidebar .revertVersion",this.restoreVersion.bind(this)),$(document.querySelector("#content")).on("click.revisionsTab","#app-sidebar [data-tabid=versionsTabView]",this.addCurrentVersion.bind(this))},removeVersionSidebarEvents:function(){$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("mousedown.revisions"),$(document.querySelector("#content")).off("click.revisionsTab")},addCurrentVersion:function(){if($("#lastSavedVersion").remove(),$("#currentVersion").remove(),this.getFileModel()){var e=OC.MimeType.getIconUrl(this.getFileModel().get("mimetype")),n=this.getFileModel().get("mtime");$("#versionsTabView").prepend('<ul id="lastSavedVersion"><li data-revision="0"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Last saved version")+'<br /><span class="versiondate has-tooltip live-relative-timestamp" data-timestamp="'+n+'"></span></div></div></li></ul>'),$("#versionsTabView").prepend('<ul id="currentVersion"><li data-revision="" class="active"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Current version")+"</a></div></div></li></ul>"),$(".live-relative-timestamp").each((function(){$(this).text(OC.Util.relativeModifiedDate(parseInt($(this).attr("data-timestamp"),10)))}))}},showRevHistory:function(){this.handlers.showRevHistory&&this.handlers.showRevHistory(this)||this.getFileList()&&(this.getFileList().showDetailsView(this.fileName,"versionsTabView"),this.addCurrentVersion())},showVersionPreview:function(e){e.preventDefault();var t=e.currentTarget.parentElement.parentElement;$(e.currentTarget).hasClass("downloadVersion")&&(t=e.currentTarget.parentElement.parentElement.parentElement.parentElement);var n=t.dataset.revision,r=this.fileId,i=this.fileName;console.debug("[FilesAppIntegration] showVersionPreview",n,r,i),this.sendPostMessage("Action_loadRevViewer",{fileId:r,title:i,version:n}),$(t.parentElement.parentElement).find("li").removeClass("active"),$(t).addClass("active")},restoreVersion:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.sendPostMessage("Host_VersionRestore",{Status:"Pre_Restore"});var n=e.currentTarget.parentElement.parentElement.dataset.revision;return this._restoreVersionCallback=function(){t._restoreDAV(n),t._restoreVersionCallback=null},!1},restoreVersionExecute:function(){null!==this._restoreVersionCallback&&this._restoreVersionCallback()},restoreVersionAbort:function(){this._restoreVersionCallback=null},_restoreSuccess:function(e){"error"===e.status&&OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version")),document.getElementById("richdocumentsframe").src=document.getElementById("richdocumentsframe").src,OC.Apps.hideAppSidebar()},_restoreError:function(){OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version"))},_restoreDAV:function(e){var t=OC.linkToRemoteBase("dav")+"/versions/"+OC.getCurrentUser().uid+"/versions/"+this.fileId+"/"+e;$.ajax({type:"MOVE",url:t,headers:{Destination:OC.linkToRemote("dav")+"/versions/"+OC.getCurrentUser().uid+"/restore/target"},success:this._restoreSuccess.bind(this),error:this._restoreError.bind(this)})},createNewFile:function(e){this.handlers.createNewFile&&this.handlers.createNewFile(this,{type:e})||OC.dialogs.prompt(t("richdocuments","Please enter the filename for the new document"),t("richdocuments","Save As"),(function(t,n){if(!0===t&&n){"text"===e&&(e="document");var r=parent.$("#dir").val(),i=OC.generateUrl("/apps/files/?dir="+r+"&richdocuments_create="+e+"&richdocuments_filename="+encodeURI(n));window.open(i,"_blank")}}),!0,t("richdocuments","New filename"),!1).then((function(){var e=parent.$(".oc-dialog:visible").find("button");e.eq(0).text(t("richdocuments","Cancel")),e.eq(1).text(t("richdocuments","Create a new document"))}))},preloadOpen:function(){if(!this.handlers.preloadOpen||!this.handlers.preloadOpen(this)){var e=i.a.open.id,t=i.a.open.filename;setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var n=l(Object(o.b)(t),2)[1],r=FileList.getModelForFile(n);OCA.RichDocuments.open({path:t,fileId:e,fileModel:r,fileList:window.FileList})}))}),250)}},preloadCreate:function(){this.handlers.preloadCreate&&this.handlers.preloadCreate(this)||setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var e=a.a.getFileType(i.a.create.type,s.a.get("ooxml"));c.a._openTemplatePicker(i.a.create.type,e.mime,i.a.create.filename+"."+e.extension)}))}),250)}}},function(e,t,n){var r=n(0);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},,function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n(59),i=n(81),o=n(11),a=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null===t?null:decodeURI(t[1])||""},s=function(e){var t=e.fileId,n=e.title,a=e.readOnly,s=e.closeButton,c=e.revisionHistory,l=window.location.protocol+"//"+window.location.host+Object(r.getRootUrl)()+"/index.php/apps/richdocuments/wopi/files/"+t;console.debug("[getWopiUrl] "+l);var u=encodeURIComponent(l);return o.a.get("urlsrc")+"WOPISrc="+u+"&title="+encodeURIComponent(n)+"&lang="+Object(i.a)()+(s?"&closebutton=1":"")+(c?"&revisionhistory=1":"")+(a?"&permission=readonly":"")},c=function(e,t,n,r){return OC.generateUrl("apps/richdocuments/indexTemplate?templateId={templateId}&fileName={fileName}&dir={dir}&requesttoken={requesttoken}",{templateId:e,fileName:t,dir:n,requesttoken:OC.requestToken})},l=function(e,t){return OC.generateUrl("apps/richdocuments/public?shareToken={shareToken}&fileName={fileName}&requesttoken={requesttoken}&fileId={fileId}",{shareToken:document.getElementById("sharingToken").value,fileName:e,fileId:t,requesttoken:OC.requestToken})},u=function(e,t){return OC.generateUrl("apps/richdocuments/index?fileId={fileId}&requesttoken={requesttoken}",{fileId:t,dir:e,requesttoken:OC.requestToken})}},,,function(e,t,n){var r=n(25),i=n(128),o=n(124);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(51);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},,,function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(55),i=n(159),o=n(156);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function s(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],i=0;i<e.length;i++){var o=e[i],c=t.base?o[0]+t.base:o[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var d=s(u),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(a[d].references++,a[d].updater(f)):a.push({identifier:u,updater:v(f,t),references:1}),r.push(u)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,d=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function f(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function p(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,m=0;function v(e,t){var n,r,i;if(t.singleton){var o=m++;n=h||(h=l(t)),r=f.bind(null,n,o,!1),i=f.bind(null,n,o,!0)}else n=l(t),r=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=s(n[r]);a[i].references--}for(var o=c(e,t),l=0;l<n.length;l++){var u=s(n[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=o}}}},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){var t=r(e,4),n=t[1],i=t[3];if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),s="/*# ".concat(a," */"),c=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(c).concat([s]).join("\n")}return[n].join("\n")}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},,,function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(57);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){"use strict";var r=n(31),i=Object(r.d)("richdocuments_create"),o=Object(r.d)("richdocuments_open"),a={};
/*
 * @copyright Copyright (c) 2020 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */i&&(a.create={type:Object(r.d)("richdocuments_create"),filename:Object(r.d)("richdocuments_filename")}),o&&(a.open={filename:o,id:Object(r.d)("richdocuments_fileId")}),t.a=a},,function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(5),i=n(34),o=n(20),a=n(74),s=n(129),c=n(266),l=c.get,u=c.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,f=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),u(n).source=d.join("string"==typeof t?t:"")),e!==r?(c?!f&&e[t]&&(l=!0):delete e[t],l?e[t]=n:i(e,t,n)):l?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},,function(e,t,n){var r=n(19);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";n(264),n(279),n(282),n(141),n(287),n(288),Object.defineProperty(t,"__esModule",{value:!0}),t.getRootUrl=t.generateFilePath=t.imagePath=t.generateUrl=t.generateOcsUrl=t.generateRemoteUrl=t.linkTo=void 0;t.linkTo=function(e,t){return r(e,"",t)};t.generateRemoteUrl=function(e){return window.location.protocol+"//"+window.location.host+function(e){return i()+"/remote.php/"+e}(e)};t.generateOcsUrl=function(e,t){return t=2!==t?1:2,window.location.protocol+"//"+window.location.host+i()+"/ocs/v"+t+".php/"+e+"/"};t.generateUrl=function(e,t,n){var r=Object.assign({escape:!0,noRewrite:!1},n||{}),o=function(e,t){return t=t||{},e.replace(/{([^{}]*)}/g,(function(e,n){var i=t[n];return r.escape?"string"==typeof i||"number"==typeof i?encodeURIComponent(i.toString()):encodeURIComponent(e):"string"==typeof i||"number"==typeof i?i.toString():e}))};return"/"!==e.charAt(0)&&(e="/"+e),!0!==OC.config.modRewriteWorking||r.noRewrite?i()+"/index.php"+o(e,t||{}):i()+o(e,t||{})};t.imagePath=function(e,t){return-1===t.indexOf(".")?r(e,"img",t+".svg"):r(e,"img",t)};var r=function(e,t,n){var r=-1!==OC.coreApps.indexOf(e),o=i();return"php"!==n.substring(n.length-3)||r?"php"===n.substring(n.length-3)||r?(o+="settings"!==e&&"core"!==e&&"search"!==e||"ajax"!==t?"/":"/index.php/",r||(o+="apps/"),""!==e&&(o+=e+="/"),t&&(o+=t+"/"),o+=n):(o=OC.appswebroots[e],t&&(o+="/"+t+"/"),"/"!==o.substring(o.length-1)&&(o+="/"),o+=n):(o+="/index.php/apps/"+e,"index.php"!==n&&(o+="/",t&&(o+=encodeURI(t+"/")),o+=n)),o};t.generateFilePath=r;var i=function(){return OC.webroot};t.getRootUrl=i},,,,,,,,,,,,function(e,t,n){var r=n(5),i=n(122).f,o=n(34),a=n(52),s=n(74),c=n(270),l=n(276);e.exports=function(e,t){var n,u,d,f,p,h=e.target,m=e.global,v=e.stat;if(n=m?r:v?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in t){if(f=t[u],d=e.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(m?u:h+(v?".":"#")+u,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,u,f,e)}}},function(e,t,n){var r=n(125),i=n(50);e.exports=function(e){return r(i(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(5),i=n(34);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r={};r[n(76)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){var r=n(5),i=n(131),o=n(20),a=n(132),s=n(140),c=n(283),l=i("wks"),u=r.Symbol,d=c?u:u&&u.withoutSetter||a;e.exports=function(e){return o(l,e)||(s&&o(u,e)?l[e]=u[e]:l[e]=d("Symbol."+e)),l[e]}},function(e,t,n){"use strict";var r,i,o=n(142),a=n(286),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),d=a.UNSUPPORTED_Y||a.BROKEN_CARET,f=void 0!==/()??/.exec("")[1];(u||f||d)&&(l=function(e){var t,n,r,i,a=this,l=d&&a.sticky,p=o.call(a),h=a.source,m=0,v=e;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),v=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(h="(?: "+h+")",v=" "+v,m++),n=new RegExp("^(?:"+h+")",p)),f&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(t=a.lastIndex),r=s.call(l?n:a,v),l?r?(r.input=r.input.slice(m),r[0]=r[0].slice(m),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),f&&r&&r.length>1&&c.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=l},function(e,t,n){var r=n(300),i=n(56);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(6),i=n(39);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){"use strict";var r,i,o=n(243),a=n(317),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),d=a.UNSUPPORTED_Y||a.BROKEN_CARET,f=void 0!==/()??/.exec("")[1];(u||f||d)&&(l=function(e){var t,n,r,i,a=this,l=d&&a.sticky,p=o.call(a),h=a.source,m=0,v=e;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),v=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(h="(?: "+h+")",v=" "+v,m++),n=new RegExp("^(?:"+h+")",p)),f&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(t=a.lastIndex),r=s.call(l?n:a,v),l?r?(r.input=r.input.slice(m),r[0]=r[0].slice(m),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),f&&r&&r.length>1&&c.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=l},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(99),i=function(){var e=Object(r.getLanguage)().replace(/_/g,"-"),t=Object(r.getLocale)();"de-DE"===e&&(e="de");var n={de:{de_CH:"de-CH",gsw:"de-CH",gsw_CH:"de-CH"},fr:{fr_CH:"fr-CH"},it:{it_CH:"it-CH"}}[e];return void 0!==n&&void 0!==n[t]?n[t]:e},o=function(e){var t=e.split("\\").pop().split("/").pop();return[e.substr(0,e.length-t.length-1),t]}},,function(e,t,n){"use strict";var r=n(16),i="ooxml"===Object(r.getCapabilities)().richdocuments.config.doc_format,o=function(){return i?{document:{extension:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},spreadsheet:{extension:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},presentation:{extension:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}}:{document:{extension:"odt",mime:"application/vnd.oasis.opendocument.text"},spreadsheet:{extension:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"},presentation:{extension:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}};t.a={getFileTypes:o,getFileType:function(e){return o()[e]}}},,,,,,,,function(e,t,n){var r=n(38);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){var r=n(91),i=n(151),o=n(148);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},,,,,,function(e,t,n){var r=n(6),i=n(39),o=n(27),a=n(79),s=n(160),c=n(302),l=c.get,u=c.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,f=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),u(n).source=d.join("string"==typeof t?t:"")),e!==r?(c?!f&&e[t]&&(l=!0):delete e[t],l?e[t]=n:i(e,t,n)):l?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(e,t,n){"use strict";function r(){return"undefined"==typeof OC?(console.warn("No OC found"),"en"):OC.getLocale()}n(100),n(244),Object.defineProperty(t,"__esModule",{value:!0}),t.getLocale=r,t.getCanonicalLocale=function(){return r().replace(/_/g,"-")},t.getLanguage=function(){if("undefined"==typeof OC)return console.warn("No OC found"),"en";return OC.getLanguage()},t.translate=function(e,t,n,r,i){if("undefined"==typeof OC)return console.warn("No OC found"),t;return OC.L10N.translate(e,t,n,r,i)},t.translatePlural=function(e,t,n,r,i,o){if("undefined"==typeof OC)return console.warn("No OC found"),t;return OC.L10N.translatePlural(e,t,n,r,i,o)},t.getFirstDay=function(){if(void 0===window.firstDay)return console.warn("No firstDay found"),1;return window.firstDay},t.getDayNames=function(){if(void 0===window.dayNames)return console.warn("No dayNames found"),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return window.dayNames},t.getDayNamesShort=function(){if(void 0===window.dayNamesShort)return console.warn("No dayNamesShort found"),["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat."];return window.dayNamesShort},t.getDayNamesMin=function(){if(void 0===window.dayNamesMin)return console.warn("No dayNamesMin found"),["Su","Mo","Tu","We","Th","Fr","Sa"];return window.dayNamesMin},t.getMonthNames=function(){if(void 0===window.monthNames)return console.warn("No monthNames found"),["January","February","March","April","May","June","July","August","September","October","November","December"];return window.monthNames},t.getMonthNamesShort=function(){if(void 0===window.monthNamesShort)return console.warn("No monthNamesShort found"),["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."];return window.monthNamesShort}},function(e,t,n){"use strict";var r=n(298),i=n(80);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(25),i=n(123),o=n(124),a=n(72),s=n(126),c=n(20),l=n(127),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=a(e),t=s(t,!0),l)try{return u(e,t)}catch(e){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(0),i=n(73),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var r=n(51);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(25),i=n(0),o=n(265);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(25),i=n(127),o=n(35),a=n(126),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(130),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(5),i=n(74),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(269),i=n(130);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var r=n(20),i=n(72),o=n(135).indexOf,a=n(133);e.exports=function(e,t){var n,s=i(e),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(72),i=n(136),o=n(275),a=function(e){return function(t,n,a){var s,c=r(t),l=i(c.length),u=o(a,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(53),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(50);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(0);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){"use strict";var r=n(71),i=n(77);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t,n){"use strict";var r=n(35);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},,,,,,function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(465),i=n(230);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(45);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(91),i=n(231),o=n(232),a=n(150),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(14),i=n(92);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(14),i=n(152),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(14),i=n(234),o=n(46),a=n(235),s=n(241),c=n(485),l=i("wks"),u=r.Symbol,d=c?u:u&&u.withoutSetter||a;e.exports=function(e){return o(l,e)||(s&&o(u,e)?l[e]=u[e]:l[e]=d("Symbol."+e)),l[e]}},function(e,t,n){var r=n(55),i=n(299),o=n(156),a=n(78),s=n(157),c=n(27),l=n(158),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=a(e),t=s(t,!0),l)try{return u(e,t)}catch(e){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(57);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(55),i=n(19),o=n(301);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(55),i=n(158),o=n(47),a=n(157),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(161),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(6),i=n(79),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(305),i=n(161);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var r=n(58),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(19);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},,,,,,,,,,,,,,,function(e,t,n){var r=n(6),i=n(162),o=n(27),a=n(163),s=n(166),c=n(319),l=i("wks"),u=r.Symbol,d=c?u:u&&u.withoutSetter||a;e.exports=function(e){return o(l,e)||(s&&o(u,e)?l[e]=u[e]:l[e]=d("Symbol."+e)),l[e]}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(91),i=n(464),o=n(148),a=n(149),s=n(150),c=n(46),l=n(231),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=a(e),t=s(t,!0),l)try{return u(e,t)}catch(e){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(91),i=n(38),o=n(466);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(45);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var r=n(153),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(471),i=n(153);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.7.0",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var r=n(474),i=n(14),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(239),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(229);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(38);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){var r,i,o=n(14),a=n(487),s=o.process,c=s&&s.versions,l=c&&c.v8;l?i=(r=l.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),e.exports=i&&+i},function(e,t,n){"use strict";var r=n(47);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(318),i=n(47),o=n(320),a=n(165),s=n(58),c=n(56),l=n(321),u=n(323),d=Math.max,f=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(e,t,n,r){var v=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,y=v?"$":"$0";return[function(n,r){var i=c(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!v&&g||"string"==typeof r&&-1===r.indexOf(y)){var o=n(t,e,this,r);if(o.done)return o.value}var c=i(e),p=String(this),h="function"==typeof r;h||(r=String(r));var m=c.global;if(m){var x=c.unicode;c.lastIndex=0}for(var A=[];;){var w=u(c,p);if(null===w)break;if(A.push(w),!m)break;""===String(w[0])&&(c.lastIndex=l(p,a(c.lastIndex),x))}for(var C,O="",S=0,I=0;I<A.length;I++){w=A[I];for(var M=String(w[0]),E=d(f(s(w.index),p.length),0),j=[],T=1;T<w.length;T++)j.push(void 0===(C=w[T])?C:String(C));var F=w.groups;if(h){var k=[M].concat(j,E,p);void 0!==F&&k.push(F);var N=String(r.apply(void 0,k))}else N=b(M,p,E,j,F,r);E>=S&&(O+=p.slice(S,E)+N,S=E+M.length)}return O+p.slice(S)}];function b(e,n,r,i,a,s){var c=r+e.length,l=i.length,u=m;return void 0!==a&&(a=o(a),u=h),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>l){var d=p(u/10);return 0===d?t:d<=l?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):t}s=i[u-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return i}));var i=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.postMessageHandlers=[],this.targets=t,window.addEventListener("message",(function(e){n.handlePostMessage(e.data)}),!1)}var t,n,i;return t=e,i=[{key:"parsePostMessage",value:function(e){var t,n,r;try{var i=JSON.parse(e);t=i.MessageId,n=i.Values,r=!!i.Values.Deprecated}catch(n){t=e}return{msgId:t,args:n,deprecated:r}}}],(n=[{key:"sendPostMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";("function"==typeof this.targets[e]?this.targets[e]():this.targets[e]).postMessage(t,n),console.debug("PostMessageService.sendPostMessage",e,t)}},{key:"sendWOPIPostMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={MessageId:t,SendTime:Date.now(),Values:n};this.sendPostMessage(e,JSON.stringify(r))}},{key:"registerPostMessageHandler",value:function(e){this.postMessageHandlers.push(e)}},{key:"unregisterPostMessageHandler",value:function(e){var t=this.postMessageHandlers.findIndex((function(t){return t===e}));delete this.postMessageHandlers[t]}},{key:"handlePostMessage",value:function(t){var n=e.parsePostMessage(t);null!=n&&this.postMessageHandlers.forEach((function(e){n.deprecated?console.debug("PostMessageService.handlePostMessage","Ignoring deprecated post message",n.msgId):e({data:t,parsed:n})}))}}])&&r(t.prototype,n),i&&r(t,i),e}()},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(71),i=n(135).indexOf,o=n(277),a=n(278),s=[].indexOf,c=!!s&&1/[1].indexOf(1,-0)<0,l=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(e){return c?s.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(5),i=n(51),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r,i,o,a=n(267),s=n(5),c=n(51),l=n(34),u=n(20),d=n(268),f=n(133),p=s.WeakMap;if(a){var h=new p,m=h.get,v=h.has,g=h.set;r=function(e,t){return g.call(h,e,t),t},i=function(e){return m.call(h,e)||{}},o=function(e){return v.call(h,e)}}else{var y=d("state");f[y]=!0,r=function(e,t){return l(e,y,t),t},i=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(5),i=n(129),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(131),i=n(132),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(20),i=n(271),o=n(122),a=n(128);e.exports=function(e,t){for(var n=i(t),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(e,u)||s(e,u,c(t,u))}}},function(e,t,n){var r=n(272),i=n(274),o=n(138),a=n(35);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(273),i=n(5),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(5);e.exports=r},function(e,t,n){var r=n(134),i=n(137).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(53),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t,n){var r=n(0),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==l||n!=c&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";e.exports=o},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t,n){var r=n(25),i=n(0),o=n(20),a=Object.defineProperty,s={},c=function(e){throw e};e.exports=function(e,t){if(o(s,e))return s[e];t||(t={});var n=[][e],l=!!o(t,"ACCESSORS")&&t.ACCESSORS,u=o(t,0)?t[0]:c,d=o(t,1)?t[1]:void 0;return s[e]=!!n&&!i((function(){if(l&&!r)return!0;var e={length:-1};l?a(e,1,{enumerable:!0,get:c}):e[1]=1,n.call(e,u,d)}))}},function(e,t,n){var r=n(71),i=n(280);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){"use strict";var r=n(25),i=n(0),o=n(281),a=n(138),s=n(123),c=n(139),l=n(125),u=Object.assign,d=Object.defineProperty;e.exports=!u||i((function(){if(r&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||"abcdefghijklmnopqrst"!=o(u({},t)).join("")}))?function(e,t){for(var n=c(e),i=arguments.length,u=1,d=a.f,f=s.f;i>u;)for(var p,h=l(arguments[u++]),m=d?o(h).concat(d(h)):o(h),v=m.length,g=0;v>g;)p=m[g++],r&&!f.call(h,p)||(n[p]=h[p]);return n}:u},function(e,t,n){var r=n(134),i=n(137);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(75),i=n(52),o=n(284);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,n){var r=n(140);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){"use strict";var r=n(75),i=n(285);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){var r=n(75),i=n(73),o=n(76)("toStringTag"),a="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){"use strict";var r=n(0);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,n){"use strict";var r=n(52),i=n(35),o=n(0),a=n(142),s=RegExp.prototype,c=s.toString,l=o((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u="toString"!=c.name;(l||u)&&r(RegExp.prototype,"toString",(function(){var e=i(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in s)?a.call(e):n)}),{unsafe:!0})},function(e,t,n){"use strict";var r=n(289),i=n(35),o=n(139),a=n(136),s=n(53),c=n(50),l=n(290),u=n(292),d=Math.max,f=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(e,t,n,r){var v=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,y=v?"$":"$0";return[function(n,r){var i=c(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!v&&g||"string"==typeof r&&-1===r.indexOf(y)){var o=n(t,e,this,r);if(o.done)return o.value}var c=i(e),p=String(this),h="function"==typeof r;h||(r=String(r));var m=c.global;if(m){var x=c.unicode;c.lastIndex=0}for(var A=[];;){var w=u(c,p);if(null===w)break;if(A.push(w),!m)break;""===String(w[0])&&(c.lastIndex=l(p,a(c.lastIndex),x))}for(var C,O="",S=0,I=0;I<A.length;I++){w=A[I];for(var M=String(w[0]),E=d(f(s(w.index),p.length),0),j=[],T=1;T<w.length;T++)j.push(void 0===(C=w[T])?C:String(C));var F=w.groups;if(h){var k=[M].concat(j,E,p);void 0!==F&&k.push(F);var N=String(r.apply(void 0,k))}else N=b(M,p,E,j,F,r);E>=S&&(O+=p.slice(S,E)+N,S=E+M.length)}return O+p.slice(S)}];function b(e,n,r,i,a,s){var c=r+e.length,l=i.length,u=m;return void 0!==a&&(a=o(a),u=h),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>l){var d=p(u/10);return 0===d?t:d<=l?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):t}s=i[u-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";n(141);var r=n(52),i=n(0),o=n(76),a=n(77),s=n(34),c=o("species"),l=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),d=o("replace"),f=!!/./[d]&&""===/./[d]("a","$0"),p=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var h=o(e),m=!i((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),v=m&&!i((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!m||!v||"replace"===e&&(!l||!u||f)||"split"===e&&!p){var g=/./[h],y=n(h,""[e],(function(e,t,n,r,i){return t.exec===a?m&&!i?{done:!0,value:g.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),b=y[0],x=y[1];r(String.prototype,e,b),r(RegExp.prototype,h,2==t?function(e,t){return x.call(e,this,t)}:function(e){return x.call(e,this)})}d&&s(RegExp.prototype[h],"sham",!0)}},function(e,t,n){"use strict";var r=n(291).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(53),i=n(50),o=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),l=s.length;return c<0||c>=l?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var r=n(73),i=n(77);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},,,,,,function(e,t,n){var r=n(6),i=n(155).f,o=n(39),a=n(98),s=n(79),c=n(306),l=n(316);e.exports=function(e,t){var n,u,d,f,p,h=e.target,m=e.global,v=e.stat;if(n=m?r:v?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in t){if(f=t[u],d=e.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(m?u:h+(v?".":"#")+u,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,u,f,e)}}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(19),i=n(101),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var r=n(6),i=n(57),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r,i,o,a=n(303),s=n(6),c=n(57),l=n(39),u=n(27),d=n(304),f=n(164),p=s.WeakMap;if(a){var h=new p,m=h.get,v=h.has,g=h.set;r=function(e,t){return g.call(h,e,t),t},i=function(e){return m.call(h,e)||{}},o=function(e){return v.call(h,e)}}else{var y=d("state");f[y]=!0,r=function(e,t){return l(e,y,t),t},i=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(6),i=n(160),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(162),i=n(163),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(27),i=n(307),o=n(155),a=n(159);e.exports=function(e,t){for(var n=i(t),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(e,u)||s(e,u,c(t,u))}}},function(e,t,n){var r=n(308),i=n(310),o=n(315),a=n(47);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(309),i=n(6),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(6);e.exports=r},function(e,t,n){var r=n(311),i=n(314).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(27),i=n(78),o=n(312).indexOf,a=n(164);e.exports=function(e,t){var n,s=i(e),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(78),i=n(165),o=n(313),a=function(e){return function(t,n,a){var s,c=r(t),l=i(c.length),u=o(a,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(58),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(19),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==l||n!=c&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";e.exports=o},function(e,t,n){"use strict";var r=n(19);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,n){"use strict";n(100);var r=n(98),i=n(19),o=n(181),a=n(80),s=n(39),c=o("species"),l=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),d=o("replace"),f=!!/./[d]&&""===/./[d]("a","$0"),p=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var h=o(e),m=!i((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),v=m&&!i((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!m||!v||"replace"===e&&(!l||!u||f)||"split"===e&&!p){var g=/./[h],y=n(h,""[e],(function(e,t,n,r,i){return t.exec===a?m&&!i?{done:!0,value:g.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),b=y[0],x=y[1];r(String.prototype,e,b),r(RegExp.prototype,h,2==t?function(e,t){return x.call(e,this,t)}:function(e){return x.call(e,this)})}d&&s(RegExp.prototype[h],"sham",!0)}},function(e,t,n){var r=n(166);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(56);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(322).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(58),i=n(56),o=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),l=s.length;return c<0||c>=l?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var r=n(101),i=n(80);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,n,r){"use strict";var i=r(83),o=r(16),a={attach:function(e){var n=this,r=i.a.getFileType("document"),a=i.a.getFileType("spreadsheet"),s=i.a.getFileType("presentation");e.addMenuEntry({id:"add-"+r.extension,displayName:t("richdocuments","New Document"),templateName:t("richdocuments","New Document")+"."+r.extension,iconClass:"icon-filetype-document",fileType:"x-office-document",actionHandler:function(e){Object(o.getCapabilities)().richdocuments.templates?n._openTemplatePicker("document",r.mime,e):n._createDocument(r.mime,e)}}),e.addMenuEntry({id:"add-"+a.extension,displayName:t("richdocuments","New Spreadsheet"),templateName:t("richdocuments","New Spreadsheet")+"."+a.extension,iconClass:"icon-filetype-spreadsheet",fileType:"x-office-spreadsheet",actionHandler:function(e){Object(o.getCapabilities)().richdocuments.templates?n._openTemplatePicker("spreadsheet",a.mime,e):n._createDocument(a.mime,e)}}),e.addMenuEntry({id:"add-"+s.extension,displayName:t("richdocuments","New Presentation"),templateName:t("richdocuments","New Presentation")+"."+s.extension,iconClass:"icon-filetype-presentation",fileType:"x-office-presentation",actionHandler:function(e){Object(o.getCapabilities)().richdocuments.templates?n._openTemplatePicker("presentation",s.mime,e):n._createDocument(s.mime,e)}})},_createDocument:function(e,n){OCA.Files.Files.isFileNameValid(n),n=FileList.getUniqueName(n),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:e,filename:n,dir:document.getElementById("dir").value},(function(e){e&&"success"===e.status?FileList.add(e.data,{animate:!0,scrollTo:!0}):OC.dialogs.alert(e.data.message,t("core","Could not create file"))}))},_createDocumentFromTemplate:function(e,n,r){OCA.Files.Files.isFileNameValid(r),r=FileList.getUniqueName(r),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:n,filename:r,dir:document.getElementById("dir").value},(function(n){if(n&&"success"===n.status){FileList.add(n.data,{animate:!1,scrollTo:!1});var i=FileList.getModelForFile(r),o=document.getElementById("dir").value+"/"+r;OCA.RichDocuments.openWithTemplate({fileId:-1,path:o,templateId:e,fileList:window.FileList,fileModel:i})}else OC.dialogs.alert(n.data.message,t("core","Could not create file"))}))},_openTemplatePicker:function(e,n,r){var i=this;$.ajax({url:OC.linkToOCS("apps/richdocuments/api/v1/templates",2)+e,dataType:"json"}).then((function(e){if(1!==e.ocs.data.length)i._buildTemplatePicker(e.ocs.data).then((function(){var e=[{text:t("core","Cancel"),classes:"cancel",click:function(){$(this).ocdialog("close")}},{text:t("richdocuments","Create"),classes:"primary",click:function(){var e=this.dataset.templateId;i._createDocumentFromTemplate(e,n,r),$(this).ocdialog("close")}}];$("#template-picker").ocdialog({closeOnEscape:!0,modal:!0,buttons:e})}));else{var o=e.ocs.data[0].id;i._createDocumentFromTemplate(o,n,r)}}))},_buildTemplatePicker:function(e){var n=this;return $.get(OC.filePath("richdocuments","templates","templatePicker.html"),(function(r){var i=$(r).octemplate({dialog_name:"template-picker",dialog_title:t("richdocuments","Select template")});_.values(e).forEach((function(e){n._appendTemplateFromData(i[0],e)})),$("body").append(i)}))},_appendTemplateFromData:function(e,t){var n=e.querySelector(".template-model").cloneNode(!0);n.className="",n.querySelector("img").src=OC.generateUrl("apps/richdocuments/template/preview/"+t.id),n.querySelector("h2").textContent=t.name,n.onclick=function(){e.dataset.templateId=t.id},e.dataset.templateId||(e.dataset.templateId=t.id),e.querySelector(".template-container").appendChild(n)}};n.a=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(462),Object.defineProperty(t,"__esModule",{value:!0}),t.loadState=function(e,t,n){var r=document.querySelector("#initial-state-".concat(e,"-").concat(t));if(null===r){if(void 0!==n)return n;throw new Error("Could not find initial state ".concat(t," of ").concat(e))}try{return JSON.parse(atob(r.value))}catch(n){throw new Error("Could not parse initial state ".concat(t," of ").concat(e))}}},function(e,t,n){"use strict";var r=n(463),i=n(38),o=n(240),a=n(45),s=n(482),c=n(238),l=n(483),u=n(484),d=n(486),f=n(154),p=n(242),h=f("isConcatSpreadable"),m=p>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),v=d("concat"),g=function(e){if(!a(e))return!1;var t=e[h];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,forced:!m||!v},{concat:function(e){var t,n,r,i,o,a=s(this),d=u(a,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(g(o=-1===t?a:arguments[t])){if(f+(i=c(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,f++)n in o&&l(d,f,o[n])}else{if(f>=9007199254740991)throw TypeError("Maximum allowed index exceeded");l(d,f++,o)}return d.length=f,d}})},function(e,t,n){var r=n(14),i=n(228).f,o=n(92),a=n(467),s=n(152),c=n(472),l=n(481);e.exports=function(e,t){var n,u,d,f,p,h=e.target,m=e.global,v=e.stat;if(n=m?r:v?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in t){if(f=t[u],d=e.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(m?u:h+(v?".":"#")+u,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,u,f,e)}}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(38),i=n(229),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var r=n(14),i=n(45),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(14),i=n(92),o=n(46),a=n(152),s=n(233),c=n(468),l=c.get,u=c.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var c,l=!!s&&!!s.unsafe,f=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),(c=u(n)).source||(c.source=d.join("string"==typeof t?t:""))),e!==r?(l?!p&&e[t]&&(f=!0):delete e[t],f?e[t]=n:i(e,t,n)):f?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(e,t,n){var r,i,o,a=n(469),s=n(14),c=n(45),l=n(92),u=n(46),d=n(153),f=n(470),p=n(236),h=s.WeakMap;if(a){var m=d.state||(d.state=new h),v=m.get,g=m.has,y=m.set;r=function(e,t){return t.facade=e,y.call(m,e,t),t},i=function(e){return v.call(m,e)||{}},o=function(e){return g.call(m,e)}}else{var b=f("state");p[b]=!0,r=function(e,t){return t.facade=e,l(e,b,t),t},i=function(e){return u(e,b)?e[b]:{}},o=function(e){return u(e,b)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(14),i=n(233),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(234),i=n(235),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(46),i=n(473),o=n(228),a=n(151);e.exports=function(e,t){for(var n=i(t),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(e,u)||s(e,u,c(t,u))}}},function(e,t,n){var r=n(237),i=n(475),o=n(480),a=n(232);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(14);e.exports=r},function(e,t,n){var r=n(476),i=n(479).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(46),i=n(149),o=n(477).indexOf,a=n(236);e.exports=function(e,t){var n,s=i(e),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(149),i=n(238),o=n(478),a=function(e){return function(t,n,a){var s,c=r(t),l=i(c.length),u=o(a,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(239),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(38),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==l||n!=c&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";e.exports=o},function(e,t,n){var r=n(230);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(150),i=n(151),o=n(148);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){var r=n(45),i=n(240),o=n(154)("species");e.exports=function(e,t){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var r=n(241);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(38),i=n(154),o=n(242),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var r=n(237);e.exports=r("navigator","userAgent")||""},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(41),i=n.n(r),o=n(42),a=n.n(o),s=n(511),c=n.n(s),l=n(594),u=n(595),d=n(596),f=a()(i.a),p=c()(l.a),h=c()(u.a),m=c()(d.a);f.push([e.i,"#odf-canvas{position:relative;top:37px;left:0px;border:1px solid darkgray;border-left:0 none;box-shadow:0px 4px 10px #000;-moz-box-shadow:0px 4px 10px #000;-webkit-box-shadow:0px 4px 10px #000}.icon-filetype-document{background-image:url("+p+")}.icon-filetype-spreadsheet{background-image:url("+h+")}.icon-filetype-presentation{background-image:url("+m+")}.richdocuments-sharing .icon-shared{display:block;width:16px;height:16px;padding:16px;opacity:0.6}.richdocuments-sharing .icon-shared:hover,.richdocuments-sharing .icon-shared:focus{opacity:1}#richdocumentsframe{background-color:#fff;width:100%;height:calc(100vh - 50px);display:block;position:absolute;top:0;z-index:110}#editors-menu{min-width:200px;top:50px}#editors-menu ul li{display:flex;padding:3px;border-left:3px solid transparent}#editors-menu ul li.active{border-left:3px solid var(--color-primary)}#editors-menu ul li .label{padding:6px;flex-grow:1}#editors-menu ul li .label .icon-play-next{opacity:.5;display:inline-block;padding-left:10px;vertical-align:top}#editors-menu ul li label.label::before{margin-right:16px;margin-left:7px}#editors-menu ul li .icon-close{padding:8px}#richdocuments-avatars{position:relative;right:-15px}#richdocuments-avatars>.richdocuments-avatar{float:right;border-radius:50%;margin:8px;margin-left:-20px;box-shadow:0px 0px 3px rgba(0,0,0,0.5);position:relative}#richdocuments-avatars>.richdocuments-avatar.read-only{opacity:0.8}#richdocuments-header{display:flex}#richdocuments-header>div .icon-shared,#richdocuments-header>div .icon-more{display:block;min-width:50px;height:50px}#richdocuments-actions{position:relative}#richdocuments-actions li{white-space:nowrap}#richdocuments-actions li a.icon-loading-small:after{left:19px}#versionsTabView li{padding-left:15px;margin-left:-15px}#versionsTabView li.active{border-left:3px solid var(--color-primary, #000);padding-left:12px}#currentVersion li,#lastSavedVersion li{border-bottom:1px solid rgba(100,100,100,0.1)}#currentVersion li .version-container .downloadVersion,#lastSavedVersion li .version-container .downloadVersion{display:flex;flex-direction:column;margin-left:12px}#template-picker .template-container:not(.hidden){display:flex;flex-wrap:wrap}#template-picker .template-container:not(.hidden) a{border-radius:var(--border-radius);border:1px solid var(--color-border);margin:10px;position:relative}#template-picker .template-container:not(.hidden) a:hover,#template-picker .template-container:not(.hidden) a:focus{border-color:var(--color-primary-element)}#template-picker .template-container:not(.hidden) a>span{display:flex;flex-direction:column;width:170px;margin:10px;cursor:pointer}#template-picker .template-container:not(.hidden) a>span>img,#template-picker .template-container:not(.hidden) a>span>span{width:170px;height:240.42857px;background-color:var(--color-background-dark);background-size:24px}#template-picker .template-container:not(.hidden) a>span>h2{margin-top:10px;font-size:inherit}\n","",{version:3,sources:["webpack://css/viewer.scss","webpack://css/templatePicker.scss"],names:[],mappings:"AAAA,YACC,iBAAkB,CAClB,QAAS,CACT,QAAS,CACT,yBAAyB,CACzB,kBAAkB,CAClB,4BAA6B,CAC7B,iCAAkC,CAClC,oCAAqC,CACrC,wBAGA,wDAAqD,CACrD,2BAGA,wDAAwD,CACxD,4BAGA,wDAAyD,CACzD,oCAGA,aAAc,CACd,UAAW,CACX,WAAY,CACZ,YAAa,CACb,WAAY,CACZ,oFAIA,SAAU,CACV,oBAGA,qBAAsB,CACtB,UAAU,CACV,yBAA0B,CAC1B,aAAa,CACb,iBAAiB,CACjB,KAAK,CACL,WAAW,CACX,cAGA,eAAgB,CAChB,QAAS,CAFV,oBAKE,YAAa,CACb,WAAY,CACZ,iCAAkC,CAPpC,2BASG,0CAA2C,CAT9C,2BAaG,WAAY,CACZ,WAAY,CAdf,2CAiBI,UAAW,CACX,oBAAqB,CACrB,iBAAkB,CAClB,kBAAmB,CApBvB,wCAwBG,iBAAkB,CAClB,eAAgB,CAzBnB,gCA4BG,WAAY,CACZ,uBAKF,iBAAkB,CAClB,WAAY,CAFb,6CAKE,WAAY,CACZ,iBAAkB,CAClB,UAAW,CACX,iBAAkB,CAClB,sCAA0C,CAC1C,iBAAkB,CAVpB,uDAYG,WAAY,CACZ,sBAKF,YAAa,CADd,4EAIE,aAAc,CACd,cAAe,CACf,WAAY,CACZ,uBAID,iBAAkB,CADnB,0BAGE,kBAAmB,CAHrB,qDAKG,SAAU,CACV,oBAKF,iBAAkB,CAClB,iBAAkB,CAClB,2BAGA,gDAAiD,CACjD,iBAAkB,CAClB,wCAIA,6CAA6C,CAF9C,gHAKE,YAAa,CACb,qBAAsB,CACtB,gBAAiB,CACjB,kDC9GA,YAAa,CACb,cAAe,CAHjB,oDAQG,kCAAmC,CACnC,oCAAqC,CACrC,WAHY,CAIZ,iBAAkB,CAXrB,oHAeI,yCAA0C,CAf9C,yDAmBI,YAAa,CACb,qBAAsB,CACtB,WAhBW,CAiBX,WAfW,CAgBX,cAAe,CAvBnB,2HA0BK,WArBU,CAsBV,kBArBuB,CAsBvB,6CAA8C,CAC9C,oBAAqB,CA7B1B,4DAgCK,eAzBU,CA0BV,iBAAkB",sourcesContent:["#odf-canvas{\n\tposition: relative;\n\ttop: 37px;\n\tleft: 0px;\n\tborder:1px solid darkgray;\n\tborder-left:0 none;\n\tbox-shadow: 0px 4px 10px #000;\n\t-moz-box-shadow: 0px 4px 10px #000;\n\t-webkit-box-shadow: 0px 4px 10px #000;\n}\n\n.icon-filetype-document{\n\tbackground-image: url('../img/x-office-document.svg')\n}\n\n.icon-filetype-spreadsheet{\n\tbackground-image: url('../img/x-office-spreadsheet.svg');\n}\n\n.icon-filetype-presentation{\n\tbackground-image: url('../img/x-office-presentation.svg');\n}\n\n.richdocuments-sharing .icon-shared {\n\tdisplay: block;\n\twidth: 16px;\n\theight: 16px;\n\tpadding: 16px;\n\topacity: 0.6;\n}\n\n.richdocuments-sharing .icon-shared:hover,\n.richdocuments-sharing .icon-shared:focus {\n\topacity: 1;\n}\n\n#richdocumentsframe {\n\tbackground-color: #fff;\n\twidth:100%;\n\theight: calc(100vh - 50px);\n\tdisplay:block;\n\tposition:absolute;\n\ttop:0;\n\tz-index:110;\n}\n\n#editors-menu {\n\tmin-width: 200px;\n\ttop: 50px;\n\n\tul li {\n\t\tdisplay: flex;\n\t\tpadding: 3px;\n\t\tborder-left: 3px solid transparent;\n\t\t&.active {\n\t\t\tborder-left: 3px solid var(--color-primary);\n\t\t}\n\n\t\t.label {\n\t\t\tpadding: 6px;\n\t\t\tflex-grow: 1;\n\n\t\t\t.icon-play-next {\n\t\t\t\topacity: .5;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tpadding-left: 10px;\n\t\t\t\tvertical-align: top;\n\t\t\t}\n\t\t}\n\t\tlabel.label::before {\n\t\t\tmargin-right: 16px;\n\t\t\tmargin-left: 7px;\n\t\t}\n\t\t.icon-close {\n\t\t\tpadding: 8px;\n\t\t}\n\t}\n}\n\n#richdocuments-avatars {\n\tposition: relative;\n\tright: -15px;\n\n\t& > .richdocuments-avatar {\n\t\tfloat: right;\n\t\tborder-radius: 50%;\n\t\tmargin: 8px;\n\t\tmargin-left: -20px;\n\t\tbox-shadow: 0px 0px 3px rgba(0, 0, 0, 0.5);\n\t\tposition: relative;\n\t\t&.read-only {\n\t\t\topacity: 0.8;\n\t\t}\n\t}\n}\n\n#richdocuments-header {\n\tdisplay: flex;\n\t& > div .icon-shared,\n\t& > div .icon-more {\n\t\tdisplay: block;\n\t\tmin-width: 50px;\n\t\theight: 50px;\n\t}\n}\n\n#richdocuments-actions {\n\tposition: relative;\n\tli {\n\t\twhite-space: nowrap;\n\t\ta.icon-loading-small:after {\n\t\t\tleft: 19px;\n\t\t}\n\t}\n}\n\n#versionsTabView li {\n\tpadding-left: 15px;\n\tmargin-left: -15px;\n}\n\n#versionsTabView li.active {\n\tborder-left: 3px solid var(--color-primary, #000);\n\tpadding-left: 12px;\n}\n\n#currentVersion li,\n#lastSavedVersion li {\n\tborder-bottom: 1px solid rgba(100,100,100,.1);\n\n\t.version-container .downloadVersion {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-left: 12px;\n\t}\n}\n\n@import 'templatePicker';\n","/**\n * @copyright Copyright (c) 2018, John Molakvoæ (skjnldsv@protonmail.com)\n *\n * @author John Molakvoæ (skjnldsv) <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n#template-picker {\n\t.template-container:not(.hidden) {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\ta {\n\t\t\t$size: 170px;\n\t\t\t$sizeY: $size / 210 * 297;\n\t\t\t$space: 10px;\n\t\t\tborder-radius: var(--border-radius);\n\t\t\tborder: 1px solid var(--color-border);\n\t\t\tmargin: $space;\n\t\t\tposition: relative;\n\n\t\t\t&:hover,\n\t\t\t&:focus {\n\t\t\t\tborder-color: var(--color-primary-element);\n\t\t\t}\n\n\t\t\t> span {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\twidth: $size;\n\t\t\t\tmargin: $space;\n\t\t\t\tcursor: pointer;\n\t\t\t\t> img,\n\t\t\t\t> span {\n\t\t\t\t\twidth: $size;\n\t\t\t\t\theight: $sizeY;\n\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t\tbackground-size: 24px;\n\t\t\t\t}\n\t\t\t\t> h2 {\n\t\t\t\t\tmargin-top: $space;\n\t\t\t\t\tfont-size: inherit;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),t.a=f},,,,,,,,,,function(e,t,n){"use strict";t.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM0OWFiZWEiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgMmg2djFoLTZ2LTF6bTAgM2g1djFoLTV2LTF6bTAgM2g4djFoLTh2LTF6bTAgM2g0djFoLTR2LTF6Ii8+PC9zdmc+Cg=="},function(e,t,n){"use strict";t.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM5YWJkNGUiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgM2gydjJoLTJ2LTJ6bTMgMGg1djJoLTV2LTJ6bS0zIDNoMnYyaC0ydi0yem0zIDBoNXYyaC01di0yem0tMyAzaDJ2MmgtMnYtMnptMyAwaDV2MmgtNXYtMnoiLz48L3N2Zz4K"},function(e,t,n){"use strict";t.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGZpbGw9IiNmMDk2NWYiIGQ9Im0xLjUgMmMtMC4yNSAwLTAuNSAwLjI1LTAuNSAwLjV2MTFjMCAwLjI1IDAuMjUgMC41IDAuNSAwLjVoMTNjMC4yNSAwIDAuNS0wLjI1IDAuNS0wLjV2LTExYzAtMC4yNS0wLjI1LTAuNS0wLjUtMC41em0wLjUgM2gxMnY2aC0xMnoiLz48L3N2Zz4K"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,r){"use strict";r.r(n);var i=r(31),o=r(245),a=r(11),s=r(48),c=r(83),l=r(24),u=r(40),d=r.n(u),f=r(584),p={insert:"head",singleton:!1},h=(d()(f.a,p),f.a.locals,r(81)),m=r(324),v=r(16);function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var O=new o.a({FRAME_DOCUMENT:function(){return document.getElementById("richdocumentsframe").contentWindow}}),S=document.getElementById("hideDownload")&&"true"===document.getElementById("hideDownload").value,I=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,M={open:!1,receivedLoading:!1,isCollaboraConfigured:-1!==Object(v.getCapabilities)().richdocuments.config.wopi_url.indexOf("proxy.php")||"object"===C(Object(v.getCapabilities)().richdocuments.collabora)&&0!==Object(v.getCapabilities)().richdocuments.collabora.length,supportedMimes:Object(v.getCapabilities)().richdocuments.mimetypes.concat(Object(v.getCapabilities)().richdocuments.mimetypesNoDefaultOpen),excludeMimeFromDefaultOpen:Object(v.getCapabilities)().richdocuments.mimetypesNoDefaultOpen,hideDownloadMimes:["image/jpeg","image/svg+xml","image/cgm","image/vnd.dxf","image/x-emf","image/x-wmf","image/x-wpg","image/x-freehand","image/bmp","image/png","image/gif","image/tiff","image/jpg","image/jpeg","text/plain","application/pdf"],registerFileActions:function(){var e,n=this,r="Edit with "+Object(v.getCapabilities)().richdocuments.productName,i=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=A(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(M.supportedMimes);try{for(i.s();!(e=i.n()).done;){var o=e.value;OCA.Files.fileActions.register(o,r,OC.PERMISSION_READ,OC.imagePath("core","actions/rename"),(function(e,t){var r=t.fileList.findFile(e).shareOwnerId;return n.onEdit(e,b(b({},t),{},{shareOwnerId:r}))}),t("richdocuments","Edit with {productName}",{productName:Object(v.getCapabilities)().richdocuments.productName},void 0,{escape:!1})),(-1===M.excludeMimeFromDefaultOpen.indexOf(o)||S)&&OCA.Files.fileActions.setDefault(o,r)}}catch(e){i.e(e)}finally{i.f()}},onEdit:function(e,n){if(M.isCollaboraConfigured){if(!0!==M.open){if(M.open=!0,n)var r=n.dir,o=n.fileId||n.$file.attr("data-id"),a=n.templateId;l.a.startLoading(),M.receivedLoading=!1;var c=Object(i.a)(r,o);I&&(c=Object(i.b)(e,o)),void 0!==a&&(c=Object(i.c)(a,e,r));n&&function(e,t){var n=s.a.open?parseInt(s.a.open.id):-1;if(void 0!==t){var r=t.lastIndexOf("@");-1!==t.substr(r).indexOf("/")&&o!==n&&function(e,t){var n=!1,r=document.createElement("iframe");r.style.display="none",r.onload=function(){n=!0},document.body.appendChild(r),r.setAttribute("src",e),setTimeout((function(){n||t(),document.body.removeChild(r)}),1e3)}("https://"+t.substr(r)+"/ocs/v2.php/apps/richdocuments/api/v1/federation",(function(){console.debug("Cannot load federated instance though CSP, navigating to ",OC.generateUrl("/apps/richdocuments/open?fileId="+o)),window.location=OC.generateUrl("/apps/richdocuments/open?fileId="+o)}))}}(0,n.shareOwnerId),$("head").append($('<link rel="stylesheet" type="text/css" href="'+OC.filePath("richdocuments","css","mobile.css")+'"/>'));var u=$('<iframe id="richdocumentsframe" nonce="'+btoa(OC.requestToken)+'" scrolling="no" allowfullscreen src="'+c+'" />');M.loadingTimeout=setTimeout((function(){M.receivedLoading||(M.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to load {productName} - please try again later",{productName:Object(v.getCapabilities)().richdocuments.productName||"Collabora Online"})))}),1e3*Object(v.getCapabilities)().richdocuments.config.timeout||15e3),u.src=c,$("body").css("overscroll-behavior-y","none"),document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"),I?($("#preview").append(u).css({height:"100%"}),$("body").css({height:"100%"}),$("#content").addClass("full-height"),$("footer").addClass("hidden"),$("#imgframe").addClass("hidden"),$(".directLink").addClass("hidden"),$(".directDownload").addClass("hidden"),$("#controls").addClass("hidden"),$("#content").addClass("loading")):($("body").css("overflow","hidden"),$("#app-content").append(u),u.hide()),$("#app-content #controls").addClass("hidden"),setTimeout((function(){l.a.init({fileName:e,fileId:o,fileList:n?n.fileList:void 0,fileModel:n?n.fileModel:void 0,sendPostMessage:function(e,t){O.sendWOPIPostMessage("FRAME_DOCUMENT",e,t)}})}))}}else{var d=OC.generateUrl("/settings/admin/richdocuments"),f=OC.isUserAdmin()?'<a href="'.concat(d,'">Collabora Online is not setup yet. <br />Click here to configure your own server or connect to a demo server.</a>'):t("richdocuments","Collabora Online is not setup yet. Please contact your administrator.");OCP.Toast?OCP.Toast.error(f,{isHTML:!0,timeout:0}):OC.Notification.showHtml(f)}},onReceiveLoading:function(){M.receivedLoading=!0,$("#richdocumentsframe").prop("title","Collabora Online"),$("#richdocumentsframe").show(),$("html, body").scrollTop(0),$("#content").removeClass("loading"),l.a.initAfterReady()},onClose:function(){M.open=!1,clearTimeout(M.loadingTimeout),M.receivedLoading=!1,$('link[href*="richdocuments/css/mobile"]').remove(),$("#app-content #controls").removeClass("hidden"),$("#richdocumentsframe").remove(),$(".searchbox").show(),$("body").css("overflow","auto"),I&&($("#content").removeClass("full-height"),$("footer").removeClass("hidden"),$("#imgframe").removeClass("hidden"),$(".directLink").removeClass("hidden"),$(".directDownload").removeClass("hidden")),OC.Util.History.replaceState(),l.a.close()}},E=Object(v.getCapabilities)().richdocuments.config||{};a.a.update("ooxml","ooxml"===E.doc_format),window.OCA.RichDocuments={config:{create:c.a.getFileTypes()},open:function(e){var t=e.path,n=e.fileId,r=e.fileModel,i=e.fileList,o=void 0===i?{}:i,a=g(Object(h.b)(t),2),s=a[0],c=a[1];M.onEdit(c,{fileId:n,dir:s,shareOwnerId:r.get("shareOwnerId"),fileList:o,fileModel:r})},openWithTemplate:function(e){var t=e.path,n=e.fileId,r=e.templateId,i=e.fileModel,o=e.fileList,a=void 0===o?{}:o,s=g(Object(h.b)(t),2),c=s[0],l=s[1];M.onEdit(l,{fileId:n,dir:c,templateId:r,shareOwnerId:i.get("shareOwnerId"),fileList:a,fileModel:i})},FilesAppIntegration:{registerHandler:l.a.registerHandler.bind(l.a)}},$(document).ready((function(){"undefined"!=typeof OCA&&void 0!==OCA.Files&&void 0!==OCA.Files.fileActions&&(void 0===OCA.Files_Texteditor&&void 0===OCA.Text&&M.supportedMimes.push("text/plain"),M.registerFileActions(),OC.Plugins.register("OCA.Files.NewFileMenu",m.a)),s.a.create&&s.a.create.type&&s.a.create.filename&&l.a.preloadCreate(),s.a.open&&l.a.preloadOpen();var e=I&&-1!==M.supportedMimes.indexOf($("#mimetype").val())&&-1===M.excludeMimeFromDefaultOpen.indexOf($("#mimetype").val()),n=I&&S&&-1!==M.hideDownloadMimes.indexOf($("#mimetype").val());(e||n)&&M.onEdit(document.getElementById("filename").value),O.registerPostMessageHandler((function(e){var n=e.parsed;console.debug("[viewer] Received post message",n);var r=n.msgId,i=n.args;if(!n.deprecated){switch(r){case"loading":M.onReceiveLoading();break;case"App_LoadingStatus":"Timeout"===i.Status&&(M.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to connect to {productName}. Please try again later or contact your server administrator.",{productName:Object(v.getCapabilities)().richdocuments.productName})));break;case"UI_Share":l.a.share();break;case"UI_CreateFile":l.a.createNewFile(i.DocumentType);break;case"UI_InsertGraphic":l.a.insertGraphic((function(e,t){O.sendWOPIPostMessage("FRAME_DOCUMENT","postAsset",{FileName:e,Url:t})}));break;case"File_Rename":l.a.rename(i.NewName);break;case"Action_Save_Resp":l.a.saveAs();break;case"close":M.onClose();break;case"Get_Views_Resp":case"Views_List":l.a.setViews(i);break;case"UI_FileVersions":case"rev-history":l.a.showRevHistory();break;case"App_VersionRestore":"Pre_Restore_Ack"===i.Status&&l.a.restoreVersionExecute()}"View_Added"===r?(l.a.views[i.ViewId]=i,l.a.renderAvatars()):"View_Removed"===r?(delete l.a.views[i.ViewId],l.a.renderAvatars()):"FollowUser_Changed"===r&&(i.IsFollowEditor?l.a.followingEditor=!0:l.a.followingEditor=!1,i.IsFollowUser?l.a.following=i.FollowedViewId:l.a.following=null,l.a.renderAvatars())}}))}))}]);
//# sourceMappingURL=files.js.map